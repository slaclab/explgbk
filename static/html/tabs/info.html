<div class="container-fluid text-center tabcontainer" id="info_tab">
  <div class="row content">
    <div class="lgcontent"></div>
  </div>
</div>


<script type="text/javascript">
  $("#info_tab").on("lg.shown.bs.tab", function() {
	  var context = {};
	  window.psdm_context = context;
	  context.postGet = function() {
		  console.log("Post get");
		  var contact_info = this.info.value.contact_info;
		  var parts = contact_info.split(')')[0].split('(');
		  this.info.value.contact_name = parts[0];
		  this.info.value.contact_email = parts[1];
	  }
	  var save_function = function() {
		  $("#info_tab").find(".lg-autoupdate").prop('readonly', true);
		  var setup_details = {};
		  $("#info_tab").find(".lg-autoupdate").each(function() { setup_details[$(this).attr("data-attr")] = $(this).val()});
		  console.log(setup_details);
		  $.ajax({
			  type: "POST",
			  contentType: "application/json; charset=utf-8",
			  url: "ws/info/setup",
			  data: JSON.stringify(setup_details),
			  dataType: "json"
			})
			.done(function() {
				  $("#info_toolbar").html('<a id="info_edit" href="#"><span class="glyphicon glyphicon-edit"></span> Edit</a>');
				  $("#info_edit").on("click", edit_function);
			  })
		    .fail( function() { alert("Error when updating setup details"); })
	  }
	  var edit_function = function() {
		  $("#info_tab").find(".lg-autoupdate").prop('readonly', false);
		  $("#info_toolbar").html('<a id="info_save" href="#"><span class="glyphicon glyphicon-save"></span> Save</a>');
		  $("#info_save").on("click", save_function);
	  }
	  context.postRender = function() {
		  $("#info_edit").on("click", edit_function);
	  }
	  var requestobjs = [
		  { url: "ws/info", ctxnm: "info" }
	  ];

	  getJSONAndRender({ url: "../../static/html/ms/info_" + logbook_site + ".html" }, requestobjs, context, $("#info_tab").find(".lgcontent"));	  
  });
</script>
