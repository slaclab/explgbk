<!DOCTYPE html>
<html lang="en">
<head>
  <title>Experiment Logbook</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../../static/lgbk.css">
  <link rel=stylesheet type=text/css href="../../js/bootstrap/css/bootstrap.min.css">

  <script type="text/javascript" src="../../js/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="../../js/mustache/mustache.min.js"></script>
  <script type="text/javascript" src="../../js/lodash/lodash.min.js"></script>
  <script type="text/javascript" src="../../js/moment/min/moment-with-locales.min.js"></script>
  <script type="text/javascript" src="../../js/jquery.noty.packaged.js/jquery.noty.packaged.js"></script>
  <script type="text/javascript" src="../../js/bootstrap/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="../../js/socket.io/node_modules/socket.io-client/dist/socket.io.js"></script>
  <script type="text/javascript" src="../../js/python/flask_socket_util/websocket_client.js"></script>

  <script src="../../static/lgbk.js"></script>

  <script type="text/javascript">
    var experiment_name = "{{ experiment_name }}";
  </script>

</head>
<body>

<nav class="navbar navbar-default" role="navigation" id="myNavRow">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <ul class="nav navbar-nav">
        <li><a data-toggle="tab" data-url="../../static/html/tabs/info.html" href="#info">Info</a></li>
        <li><a data-toggle="tab" data-url="../../static/html/tabs/elog.html" href="#eLog">e-Log</a></li>
        <li><a data-toggle="tab" data-url="../../static/html/tabs/runTables.html" href="#runTables">Run Tables</a></li>
        <li><a data-toggle="tab" data-url="../../static/html/tabs/fileManager.html" href="#fileManager">File Manager</a></li>
        <li><a data-toggle="tab" data-url="../../static/html/tabs/workflow.html" href="#workflow">Workflow</a></li>
        <li><a data-toggle="tab" data-url="../../static/html/tabs/feedback.html" href="#operations">Operations</a></li>
        <li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">Misc<span class="caret"></span></a>
	        <ul class="dropdown-menu">
	          <li><a data-toggle="tab" href="#">Page 1-1</a></li>
	          <li><a data-toggle="tab" href="#">Page 1-2</a></li>
	          <li><a data-toggle="tab" href="#">Page 1-3</a></li>
	        </ul>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="../experiments"><span class="glyphicon glyphicon-home"></span>  Home</a></li>
      </ul>
    </div>
    <h3 class="exp_title">Logbook for {{ experiment_name }}</h3>
  </div>
</nav>

<div class="tab-content" id="myTabContainer">
  <div role="tabpanel" class="tab-pane fade" id="info"></div>
  <div role="tabpanel" class="tab-pane fade" id="eLog"></div>
  <div role="tabpanel" class="tab-pane fade" id="runTables"></div>
  <div role="tabpanel" class="tab-pane fade" id="fileManager"></div>
  <div role="tabpanel" class="tab-pane fade" id="workflow"></div>
  <div role="tabpanel" class="tab-pane fade" id="operations"></div>
</div>

<script type="text/javascript">

$('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
	var target = $(e.target).attr("href");
  window.location.hash = e.target.hash;
	if ($(target).is(':empty')) {
		console.log("Activated tab " + target + " is empty. Triggering load");
		var template_url = $(e.target).attr("data-url");
	    $.ajax({
	      type: "GET",
	      url: template_url,
	      error: function(data){
	        alert("Error fetching template " + template_url + ".");
	      },
	      success: function(data){
	  		console.log("Getting tab data and binding selectors");
	        $(target).html(data);
	        $(target).find(".tabcontainer").trigger("lg.shown.bs.tab", e);
	      }
	    });
	}
 });


// Code for honoring the hash; for example URL#eLog gets you to the eLog
var hash = window.location.hash;
if (hash) {
  $('ul.nav a[href="' + hash + '"]').tab('show');
} else {
	$('.navbar-nav a:first').tab('show');
}

</script>

<div class="footer navbar-fixed-bottom">
  <img alt="Brand" class="slac_logo" src="../../static/SLAC_LogoSD.png"/>
</div>

</body>
</html>
